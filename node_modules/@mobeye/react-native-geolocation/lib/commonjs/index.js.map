{"version":3,"sources":["index.ts"],"names":["start","revertTemporaryConfiguration","MobeyeGeolocation","_configuration","DEFAULT_CONFIGURATION","configure","configuration","setTemporaryConfiguration","getLastLocations","n","then","result","locations","JSON","parse","Platform","OS","forEach","location","mock","checkAccuracyAuthorization","checkIOSAuthorization","checkPermission","requestIOSAuthorization","askForPermission","getAndroidLocationProvidersStatus","getLocationProvidersStatus","checkAndroidLocationSettings","checkLocationSettings","locationEmitter","NativeEventEmitter","useLocation","setLocation","latitude","longitude","accuracy","Number","MAX_SAFE_INTEGER","time","res","catch","console","log","subscription","addListener","success","payload","remove"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Mobeye.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @format\n */\nimport MobeyeGeolocation from './nativeModule';\nimport DEFAULT_CONFIGURATION from './defaultConfiguration';\nimport {\n    AccuracyAuthorization,\n    Location,\n    LocationConfiguration,\n    LocationEvent,\n    LocationProvidersStatus,\n} from './types';\nimport { NativeEventEmitter, PermissionStatus, Platform } from 'react-native';\nimport { useEffect, useState } from 'react';\n\n/* get native module */\nconst { start, revertTemporaryConfiguration } = MobeyeGeolocation;\n\n/* init default configuration */\nconst _configuration: LocationConfiguration = DEFAULT_CONFIGURATION;\n\nexport function configure(configuration?: Partial<LocationConfiguration>): void {\n    MobeyeGeolocation.configure({\n        ..._configuration,\n        ...configuration\n    });\n}\n\nexport function setTemporaryConfiguration(configuration?: Partial<LocationConfiguration>): void {\n    MobeyeGeolocation.setTemporaryConfiguration({\n        ..._configuration,\n        ...configuration\n    });\n}\n\n/**\n * Get last `n` last locations computed by the service.\n * @param n last computed locations\n */\nexport function getLastLocations(n: number): Promise<[Location]> {\n    return MobeyeGeolocation.getLastLocations(n).then((result) => {\n        const locations: [Location] = JSON.parse(result);\n\n        if (Platform.OS === 'ios') {\n            locations.forEach(location => {\n                location.mock = false\n            })\n\n        }\n\n        return locations;\n    });\n}\n\n/**\n * Check location  accuracy authorization.\n */\nexport function checkAccuracyAuthorization(): Promise<AccuracyAuthorization> {\n    return MobeyeGeolocation.checkAccuracyAuthorization();\n}\n\n/**\n * Check location authorization for iOS.\n * To check for android just use AndroidPermissions\n */\nexport function checkIOSAuthorization(): Promise<boolean> {\n    return MobeyeGeolocation.checkPermission();\n}\n\n/**\n * Request location authorization for iOS.\n * To request for android just use AndroidPermissions\n */\nexport function requestIOSAuthorization(): Promise<PermissionStatus> {\n    return MobeyeGeolocation.askForPermission();\n}\n\n/* Get the location status for the GPS provider and the Network provider on Android */\nexport function getAndroidLocationProvidersStatus(): Promise<LocationProvidersStatus> {\n   return MobeyeGeolocation.getLocationProvidersStatus();\n}\n\n/* Check if location settings are coherent with user options and propose a resolution popup if it's possible on Android.\n * it returns a GeolocationError which is CHECK_SETTINGS_FAILURE when either the resolution is not feasible or when\n * it encounter a problem with the pendingIntent */\nexport function checkAndroidLocationSettings(): Promise<void> {\n    return MobeyeGeolocation.checkLocationSettings();\n}\n\n/* Native event emitter to catch geolocations event */\nexport const locationEmitter = new NativeEventEmitter(MobeyeGeolocation);\n\n/**\n * A React Hook which updates when the location significantly changes.\n */\nexport function useLocation(): Location {\n\n    const [location, setLocation] = useState<Location>({\n        latitude: -1,\n        longitude: -1,\n        accuracy: Number.MAX_SAFE_INTEGER,\n        time: 0,\n        mock: false,\n    });\n\n    useEffect(() => {\n        /* get last known use position */\n\n        getLastLocations(1).then((res) => {\n            res[0] && setLocation(res[0])\n        }).catch(console.log);\n\n\n\n        /* subscribe to the listener */\n        const subscription = locationEmitter.addListener('LOCATION_UPDATED', (result: LocationEvent) => {\n            if (result.success) {\n                setLocation(result.payload);\n            }\n        });\n        return () => subscription.remove();\n    }, []);\n\n    if (Platform.OS === 'ios') {\n        location.mock = false\n    }\n\n    return location;\n}\n\nexport * from './types';\nexport default {\n    configure,\n    start,\n    setTemporaryConfiguration,\n    revertTemporaryConfiguration,\n    locationEmitter,\n    getLastLocations,\n    checkIOSAuthorization,\n    requestIOSAuthorization,\n    checkAccuracyAuthorization,\n    getAndroidLocationProvidersStatus,\n    checkAndroidLocationSettings,\n};\n"]}